"use strict";

var eventstore = require('eventstore');
var es = eventstore();
var rethink = require('./databases/rethinkdb');

var es = require('eventstore')({
  type: rethink,
  host: 'store.abibao.com',                   
  port: 28015,                               
  authKey: '8UR40M2nQ8leURX262xY0OokvfhQunG4', 
  dbName: 'eventstore_deve',                  
  eventsCollectionName: 'events',             
  snapshotsCollectionName: 'snapshots',       
  transactionsCollectionName: 'transactions', 
  timeout: 10000
});

es.on('connect', function() {
  console.log('storage connected');
});

es.on('disconnect', function() {
  console.log('connection to storage is gone');
  exit();
});

es.init(function (err) {
  if (err) return console.log(1, err);
  es.getNewId(function(err, newId) {
    if (err) return console.log(2, err);
  });
});